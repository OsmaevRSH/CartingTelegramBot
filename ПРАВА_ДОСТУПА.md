# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. **–£–¥–∞–ª–µ–Ω—ã –ª–∏—à–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç—ã**
–£–¥–∞–ª–µ–Ω—ã –Ω–µ–Ω—É–∂–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∏–∑ –ø–∞–ø–∫–∏ `scripts/`:
- `debug_db.sh`
- `reset_database.sh` 
- `init_docker_dirs.sh`
- `test_database.py`
- `fix_config.sh`
- `test_local_setup.py`
- `show_db_stats.py`
- `clear_database_force.py`
- `test_bot.py`

### 2. **Docker —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏**

#### **Dockerfile**
- ‚úÖ –ó–∞–ø—É—Å–∫ –æ—Ç root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—É–¥–∞–ª–µ–Ω `USER botuser`)
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ 777 –¥–ª—è –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø–∞–ø–æ–∫
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ 755 –¥–ª—è –≤—Å–µ—Ö Python —Ñ–∞–π–ª–æ–≤
- ‚úÖ –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–µ–ª–∞—é—Ç—Å—è –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏

#### **docker-compose.yml**
- ‚úÖ `user: "0:0"` - –∑–∞–ø—É—Å–∫ –æ—Ç root
- ‚úÖ `privileged: true` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏
- ‚úÖ `cap_add: ALL` - –≤—Å–µ capabilities
- ‚úÖ `security_opt: seccomp:unconfined` - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ seccomp
- ‚úÖ Volumes —Å —Ñ–ª–∞–≥–æ–º `Z` –¥–ª—è SELinux

#### **entrypoint.sh**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∞–≤ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å –ø—Ä–∞–≤–∞–º–∏ 777
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ root –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ –í—ã–∑–æ–≤ `fix_permissions.sh` –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

### 3. **–ù–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã**

#### **scripts/fix_permissions.sh**
–°–∫—Ä–∏–ø—Ç –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞:
- –ü—Ä–∞–≤–∞ 777 –¥–ª—è `data/`, `logs/`, `config/`
- –ü—Ä–∞–≤–∞ 755 –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞
- –í–ª–∞–¥–µ–ª–µ—Ü root –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏

#### **scripts/check_permissions.py**
–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞:
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø—Ä–∞–≤–∞ –≤—Å–µ—Ö –≤–∞–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–∞–≤–∞

### 4. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π manage.sh**
–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:
- `check-perm` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- `fix-perm` - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ)

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏:
```bash
./scripts/manage.sh start
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞:
```bash
./scripts/manage.sh check-perm
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞:
```bash
./scripts/manage.sh fix-perm
```

### –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤:
```bash
./scripts/manage.sh shell
bash /app/scripts/fix_permissions.sh
```

## üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. ‚úÖ –°–æ–∑–¥–∞—é—Ç—Å—è –ø–∞–ø–∫–∏ `data/`, `logs/`, `config/`
2. ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∞ 777 –¥–ª—è –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
3. ‚úÖ –í–ª–∞–¥–µ–ª–µ—Ü —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ root:root
4. ‚úÖ –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–µ–ª–∞—é—Ç—Å—è –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
5. ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è `fix_permissions.sh` –¥–ª—è –ø–æ–ª–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üìù –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å **–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ú–ò –ü–†–ê–í–ê–ú–ò –î–û–°–¢–£–ü–ê**:
- üîì –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º –∏ –ø–∞–ø–∫–∞–º
- üëë –ó–∞–ø—É—Å–∫ –æ—Ç root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
- üõ°Ô∏è –í—Å–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- üö´ –ù–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

## ‚ö†Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–í–ù–ò–ú–ê–ù–ò–ï**: –≠—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤, –≥–¥–µ –≤—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ. –ù–∞ production —Å–µ—Ä–≤–µ—Ä–∞—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. 